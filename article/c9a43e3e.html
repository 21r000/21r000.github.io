<!-- build time:Tue Mar 29 2022 19:18:28 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="未入江湖，怎敢佩刀" href="https://www.21r000.xyz/rss.xml"><link rel="alternate" type="application/atom+xml" title="未入江湖，怎敢佩刀" href="https://www.21r000.xyz/atom.xml"><link rel="alternate" type="application/json" title="未入江湖，怎敢佩刀" href="https://www.21r000.xyz/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="Re"><link rel="canonical" href="https://www.21r000.xyz/article/c9a43e3e.html"><title>Buu-Re刷题记录 - CTF | 21r000 = 未入江湖，怎敢佩刀 = 你的骑士还没有来，你就永远是我的公主。</title><meta name="generator" content="Hexo 6.0.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">Buu-Re刷题记录</h1><div class="meta"><span class="item" title="创建时间：2022-03-22 12:47:23"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2022-03-22T12:47:23+08:00">2022-03-22</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>14k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>13 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">21r000</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/6833939bly1gipevarprfj20zk0m8npd.jpg"></li><li class="item" data-background-image="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/6833939bly1gipet8c1a2j20zk0m8kct.jpg"></li><li class="item" data-background-image="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/c9a4ea8a8dac859cc9811c020960a59.png"></li><li class="item" data-background-image="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/8499ace0f57093639a46e7c4d9e972a.png"></li><li class="item" data-background-image="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/6833939bly1giciszlczyj20zk0m816d.jpg"></li><li class="item" data-background-image="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/6833939bly1giclfdu6exj20zk0m87hw.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/CTF/" itemprop="item" rel="index" title="分类于 CTF"><span itemprop="name">CTF</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.21r000.xyz/article/c9a43e3e.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="21r000"><meta itemprop="description" content="你的骑士还没有来，你就永远是我的公主。, 固态规则长方体空间移动工程师"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="未入江湖，怎敢佩刀"></span><div class="body md" itemprop="articleBody"><p>buu 站点：<span class="exturl" data-url="aHR0cHM6Ly9idXVvai5jbi9jaGFsbGVuZ2Vz">https://buuoj.cn/challenges</span></p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/img.php" alt="img"></p><h2 id="easyre"><a class="anchor" href="#easyre">#</a> easyre</h2><p>ida 打开，即可得到 flag</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20210823161802651.png" alt="image-20210823161802651"></p><p>得到 flag：</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>flag<span class="token punctuation">&#123;</span>this_Is_a_EaSyRe<span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="reverse1"><a class="anchor" href="#reverse1">#</a> reverse1</h2><p>附件拖入 ida，shift+f12</p><p>发现这个</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20210823162842814.png" alt="image-20210823162842814"></p><p>跟进</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20210823162916116.png" alt="image-20210823162916116"></p><p>再跟进</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20210823162941081.png" alt="image-20210823162941081"></p><p>光标选中之后 F5 查看伪代码</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20210823163013123.png" alt="image-20210823163013123"></p><p>发现这个应该是将 ASCII 为 111 的替换为 48，查询后是 o 换成 0</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20210823163120913.png" alt="image-20210823163120913"></p><p>这里发现是 str1 接受 flag</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20210823163150090.png" alt="image-20210823163150090"></p><p>然后将 Str1 与 Str2 进行比较，如果相等就 <code>this is the right flag!</code></p><p>所以就去看看 Str2 里存的是什么，双击 Str2</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20210823163230185.png" alt="image-20210823163230185"></p><p>明显 o 变 0 就是 flag 了</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>flag<span class="token punctuation">&#123;</span>hell0_w0rld<span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>其实拖入 ida 发现运行主程序就不难猜出 flag 了。</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20210823163620441.png" alt="image-20210823163620441"></p><h2 id="reverse2"><a class="anchor" href="#reverse2">#</a> reverse2</h2><p>附件拖入 ida，查看主函数</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20210824150138807.png" alt="image-20210824150138807"> 可以看到 flag 输出的程序，双击跟进</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20210824150241018.png" alt="image-20210824150241018"></p><p>发现 flag 的样式，但是不难发现 flag 中存在替换，跟进加密程序</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20210824150406528.png" alt="image-20210824150406528"></p><p>可以看到<strong> i 和 r 被替换成 1</strong></p><p>所以 flag 为：</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>flag<span class="token punctuation">&#123;</span>hack1ng_fo1_fun<span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="内涵的软件"><a class="anchor" href="#内涵的软件">#</a> 内涵的软件</h2><p>图片有内涵，exe 也可以有内涵，也许你等不到答案，赶快行动起来吧！！！ 注意：得到的 flag 请包上 flag {} 提交</p><p>ida 打开查看主函数</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20210824151322066.png" alt="image-20210824151322066"></p><p>flag 白给系列。</p><h2 id="新年快乐"><a class="anchor" href="#新年快乐">#</a> 新年快乐</h2><p>过年了要不做个逆向题庆祝一下新年？说不定会有惊喜哦！注意：flag 并非是 flag {XXX} 形式，就是一个字符串，考验眼力的时候到了！ 注意：得到的 flag 请包上 flag {} 提交</p><p>ida 拖开发现套了一层壳</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20210824153007967.png" alt="image-20210824153007967"></p><p>ExeinfoPE 查壳</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20210824153031011.png" alt="image-20210824153031011"></p><p>发现有 UPX 壳，脱壳。</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>大佬总结的手动脱壳，esp定律：</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token number">1</span>.先单步到只有esp红色时，右键数据窗口跟随。</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token number">2</span>.到数据窗口后，左键硬件访问，byte和word，dword都可以任选一个，</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token number">3</span>.F9运行，遇到大跳转，时说明我们到oep了</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token number">4</span>.遇到向上跳的，用F4</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token number">5</span>.用od自带的脱壳进程，脱，一种选重建导入表，一种不选</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token number">6</span>.脱壳结束</pre></td></tr></table></figure><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/ad5cb1fa7438bd6bb55c5db9226a8fb.png" alt="ad5cb1fa7438bd6bb55c5db9226a8fb"></p><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3VweC91cHgvcmVsZWFzZXMvdGFnL3YzLjk2">upx 下载</span></p><p>拖入 ida 中查看。</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20210824154345588-16297910259171-16297910266622.png" alt="image-20210824154345588"></p><p>得到 flag：</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>flag<span class="token punctuation">&#123;</span>HappyNewYear<span class="token operator">!</span><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="xor"><a class="anchor" href="#xor">#</a> xor</h2><p>or 的敌人，and 有个兄弟叫 or,or 有个敌人叫 xor，那么你能帮助 or 战胜他的敌人 xor 吗，xor 的奥秘就在附件中，开始战斗吧！ 注意：得到的 flag 请包上 flag {} 提交</p><p>附件下载后 ida 打开进行反汇编得到如下</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [rsp+2Ch] [rbp-124h]</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token keyword">char</span> __b<span class="token punctuation">[</span><span class="token number">264</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+40h] [rbp-110h] BYREF</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token function">memset</span><span class="token punctuation">(</span>__b<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0x100uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Input your flag:\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token function">get_line</span><span class="token punctuation">(</span>__b<span class="token punctuation">,</span> <span class="token number">256LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">strlen</span><span class="token punctuation">(</span>__b<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">33</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">goto</span> LABEL_7<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">33</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    __b<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^=</span> __b<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">strncmp</span><span class="token punctuation">(</span>__b<span class="token punctuation">,</span> global<span class="token punctuation">,</span> <span class="token number">0x21uLL</span><span class="token punctuation">)</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Success"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token keyword">else</span></pre></td></tr><tr><td data-num="16"></td><td><pre>LABEL_7<span class="token operator">:</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20220322202901137.png" alt="image-20220322202901137"></p><p>对主函数进行分析：</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">strlen</span><span class="token punctuation">(</span>v6<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">33</span> <span class="token punctuation">)</span><span class="token comment">// 可以看出 flag 为 33 位</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">33</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span><span class="token comment">// 判断程序，以此来判断 flag</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    __b<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^=</span> __b<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 即 v6 [i] ^= v6 [i-1]</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">// 可以发现 xor 的规律</span></pre></td></tr></table></figure><p>双击 <code>Success</code></p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20220322203429246.png" alt="image-20220322203429246"></p><p>进入如下模块</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20220322203349270.png" alt="image-20220322203349270"></p><p>选中后 <code>shift+e</code> 进行提取</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20220322203539649.png" alt="image-20220322203539649"></p><p>得到如下字符串</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">unsigned</span> <span class="token keyword">char</span> aFKWOXZUPFVMDGH<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token number">102</span><span class="token punctuation">,</span>  <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">107</span><span class="token punctuation">,</span>  <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">119</span><span class="token punctuation">,</span>  <span class="token number">38</span><span class="token punctuation">,</span>  <span class="token number">79</span><span class="token punctuation">,</span>  <span class="token number">46</span><span class="token punctuation">,</span>  <span class="token number">64</span><span class="token punctuation">,</span>  <span class="token number">17</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token number">120</span><span class="token punctuation">,</span>  <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">90</span><span class="token punctuation">,</span>  <span class="token number">59</span><span class="token punctuation">,</span>  <span class="token number">85</span><span class="token punctuation">,</span>  <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">112</span><span class="token punctuation">,</span>  <span class="token number">25</span><span class="token punctuation">,</span>  <span class="token number">70</span><span class="token punctuation">,</span>  <span class="token number">31</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token number">118</span><span class="token punctuation">,</span>  <span class="token number">34</span><span class="token punctuation">,</span>  <span class="token number">77</span><span class="token punctuation">,</span>  <span class="token number">35</span><span class="token punctuation">,</span>  <span class="token number">68</span><span class="token punctuation">,</span>  <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span>   <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">104</span><span class="token punctuation">,</span>  <span class="token number">15</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="6"></td><td><pre>   <span class="token number">71</span><span class="token punctuation">,</span>  <span class="token number">50</span><span class="token punctuation">,</span>  <span class="token number">79</span><span class="token punctuation">,</span>   <span class="token number">0</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>设这个数组是 global 数组</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre>global<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token number">102</span><span class="token punctuation">,</span>  <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">107</span><span class="token punctuation">,</span>  <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">119</span><span class="token punctuation">,</span>  <span class="token number">38</span><span class="token punctuation">,</span>  <span class="token number">79</span><span class="token punctuation">,</span>  <span class="token number">46</span><span class="token punctuation">,</span>  <span class="token number">64</span><span class="token punctuation">,</span>  <span class="token number">17</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token number">120</span><span class="token punctuation">,</span>  <span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">90</span><span class="token punctuation">,</span>  <span class="token number">59</span><span class="token punctuation">,</span>  <span class="token number">85</span><span class="token punctuation">,</span>  <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">112</span><span class="token punctuation">,</span>  <span class="token number">25</span><span class="token punctuation">,</span>  <span class="token number">70</span><span class="token punctuation">,</span>  <span class="token number">31</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token number">118</span><span class="token punctuation">,</span>  <span class="token number">34</span><span class="token punctuation">,</span>  <span class="token number">77</span><span class="token punctuation">,</span>  <span class="token number">35</span><span class="token punctuation">,</span>  <span class="token number">68</span><span class="token punctuation">,</span>  <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span>   <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">104</span><span class="token punctuation">,</span>  <span class="token number">15</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="6"></td><td><pre>   <span class="token number">71</span><span class="token punctuation">,</span>  <span class="token number">50</span><span class="token punctuation">,</span>  <span class="token number">79</span><span class="token punctuation">,</span>   <span class="token number">0</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>我们已知： <code>0^0=0 0^1=1</code> 则对于任意 x 有 <code>0^x=x</code></p><p>还已知 若 <code>a^b=c</code> 则 <code>b=a^c=a^(a^b)=(a^a)^b=0^b=b</code></p><p>按题目中的运算规则：</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre>global<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> v6<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> v6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="2"></td><td><pre>global<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> v6<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> global<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> v6<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> v6<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> v6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="3"></td><td><pre>则</pre></td></tr><tr><td data-num="4"></td><td><pre>v6<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> global<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> global<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> v6<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> v6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> v6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> v6<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="5"></td><td><pre>v6<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> global<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span>global<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> v6<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> global<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> global<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span>v6<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> </pre></td></tr><tr><td data-num="6"></td><td><pre>…………</pre></td></tr><tr><td data-num="7"></td><td><pre>v6<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> global<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> global<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> v6<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> global<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> global<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> v6<span class="token punctuation">[</span>i<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="8"></td><td><pre>即 v6<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> global<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> global<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></pre></td></tr></table></figure><p>就是将我们的 flag xor 后和这个 gloabl 字符串比较，相等就正确了，</p><p>而我们知道两次 xor 等于没有 xor，也就是说进行两次 xor 即可还原（￣︶￣）↗</p><p>脚本如下：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>s<span class="token operator">=</span><span class="token string">""</span></pre></td></tr><tr><td data-num="2"></td><td><pre>a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">107</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">119</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">79</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">112</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">118</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">77</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">68</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">104</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">71</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">79</span> <span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    s<span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">^</span>a<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span></pre></td></tr></table></figure><p>执行脚本即可得到 flag</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20220322204437195.png" alt="image-20220322204437195"></p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre>flag<span class="token punctuation">&#123;</span>QianQiuWanDai_YiTongJiangHu<span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="helloword"><a class="anchor" href="#helloword">#</a> helloword</h2><p>有难的题目，也就有简单的题目，就像程序员一辈子编写的第一个程序，极有可能是 helloword，它很普通，但是也很让人怀念。你猜这题 flag 在哪里？让我们怀念第一次编写的 easy 程序吧！ 注意：得到的 flag 请包上 flag {} 提交</p><p>附件下载，一看后缀名 <code>.apk</code> 好吧是安卓逆向，这也是我遇到的第一个安卓逆向的题，熟悉的一梭子下来，发现 <code>ida</code> 能打开但是并不会解析什么，而 <code>ollydbg</code> 直接就打不开了，万般无奈，不懂就问百度，于是去百度了解了一波，发现一个用来解析安卓逆向的软件 <code>ApkIDE</code> ，屁颠屁颠的在网上找资源下载 ψ(｀∇´)ψ</p><p><code>ApkIDE</code> 打开查找即可得到 flag</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20220323164437436.png" alt="image-20220323164437436"></p><p>双击进入可查看详情</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20220322215214146.png" alt="image-20220322215214146"></p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre>flag<span class="token punctuation">&#123;</span><span class="token number">7631</span>a988259a00816deda84afb29430a<span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="reverse3"><a class="anchor" href="#reverse3">#</a> reverse3</h2><p>reverse3 注意：得到的 flag 请包上 flag {} 提交</p><p>附件打开进入主函数后，根据主函数执行结构可以发现一串字符串</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre>e3nifIH9b_C@n@dH</pre></td></tr></table></figure><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20220323170106661.png" alt="image-20220323170106661"></p><p>f5 反编译得到结果如下</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">int</span> __cdecl <span class="token function">main_0</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token class-name">size_t</span> v3<span class="token punctuation">;</span> <span class="token comment">// eax</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>v4<span class="token punctuation">;</span> <span class="token comment">// eax</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token class-name">size_t</span> v5<span class="token punctuation">;</span> <span class="token comment">// eax</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">char</span> v7<span class="token punctuation">;</span> <span class="token comment">// [esp+0h] [ebp-188h]</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token keyword">char</span> v8<span class="token punctuation">;</span> <span class="token comment">// [esp+0h] [ebp-188h]</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token keyword">signed</span> <span class="token keyword">int</span> j<span class="token punctuation">;</span> <span class="token comment">// [esp+DCh] [ebp-ACh]</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [esp+E8h] [ebp-A0h]</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token keyword">signed</span> <span class="token keyword">int</span> v11<span class="token punctuation">;</span> <span class="token comment">// [esp+E8h] [ebp-A0h]</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token keyword">char</span> Destination<span class="token punctuation">[</span><span class="token number">108</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+F4h] [ebp-94h] BYREF</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token keyword">char</span> Str<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+160h] [ebp-28h] BYREF</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token keyword">char</span> v14<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+17Ch] [ebp-Ch] BYREF</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span>i <span class="token operator">>=</span> <span class="token number">0x64</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>      <span class="token function">j____report_rangecheckfailure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    Destination<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>  <span class="token function">sub_41132F</span><span class="token punctuation">(</span><span class="token string">"please enter the flag:"</span><span class="token punctuation">,</span> v7<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>  <span class="token function">sub_411375</span><span class="token punctuation">(</span><span class="token string">"%20s"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span>Str<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>  v3 <span class="token operator">=</span> <span class="token function">j_strlen</span><span class="token punctuation">(</span>Str<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>  v4 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">sub_4110BE</span><span class="token punctuation">(</span>Str<span class="token punctuation">,</span> v3<span class="token punctuation">,</span> v14<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>  <span class="token function">strncpy</span><span class="token punctuation">(</span>Destination<span class="token punctuation">,</span> v4<span class="token punctuation">,</span> <span class="token number">0x28u</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>  v11 <span class="token operator">=</span> <span class="token function">j_strlen</span><span class="token punctuation">(</span>Destination<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>  <span class="token keyword">for</span> <span class="token punctuation">(</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> v11<span class="token punctuation">;</span> <span class="token operator">++</span>j <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    Destination<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+=</span> j<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>  v5 <span class="token operator">=</span> <span class="token function">j_strlen</span><span class="token punctuation">(</span>Destination<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">strncmp</span><span class="token punctuation">(</span>Destination<span class="token punctuation">,</span> Str2<span class="token punctuation">,</span> v5<span class="token punctuation">)</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token function">sub_41132F</span><span class="token punctuation">(</span><span class="token string">"rigth flag!\n"</span><span class="token punctuation">,</span> v8<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>  <span class="token keyword">else</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token function">sub_41132F</span><span class="token punctuation">(</span><span class="token string">"wrong flag!\n"</span><span class="token punctuation">,</span> v8<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20220323170143151.png" alt="image-20220323170143151"></p><p>可以看到程序是从如下部分开始执行</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span><span class="token punctuation">)</span>i <span class="token operator">>=</span> <span class="token number">0x64</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>      <span class="token function">j____report_rangecheckfailure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    Destination<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token function">sub_41132F</span><span class="token punctuation">(</span><span class="token string">"please enter the flag:"</span><span class="token punctuation">,</span> v7<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token function">sub_411375</span><span class="token punctuation">(</span><span class="token string">"%20s"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span>Str<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  v3 <span class="token operator">=</span> <span class="token function">j_strlen</span><span class="token punctuation">(</span>Str<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  v4 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">sub_4110BE</span><span class="token punctuation">(</span>Str<span class="token punctuation">,</span> v3<span class="token punctuation">,</span> v14<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token function">strncpy</span><span class="token punctuation">(</span>Destination<span class="token punctuation">,</span> v4<span class="token punctuation">,</span> <span class="token number">0x28u</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  v11 <span class="token operator">=</span> <span class="token function">j_strlen</span><span class="token punctuation">(</span>Destination<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token keyword">for</span> <span class="token punctuation">(</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> v11<span class="token punctuation">;</span> <span class="token operator">++</span>j <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    Destination<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+=</span> j<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  v5 <span class="token operator">=</span> <span class="token function">j_strlen</span><span class="token punctuation">(</span>Destination<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">strncmp</span><span class="token punctuation">(</span>Destination<span class="token punctuation">,</span> Str2<span class="token punctuation">,</span> v5<span class="token punctuation">)</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token function">sub_41132F</span><span class="token punctuation">(</span><span class="token string">"rigth flag!\n"</span><span class="token punctuation">,</span> v8<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  <span class="token keyword">else</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token function">sub_41132F</span><span class="token punctuation">(</span><span class="token string">"wrong flag!\n"</span><span class="token punctuation">,</span> v8<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>输入的字符串经过 <code>sub_4110BE函数</code> 进行加密，然后再通过一个 for 循环进行变换，然后与 str 进行比较<br>直接查看 Str2 的字符串：</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20220323170700391.png" alt="image-20220323170700391"></p><p>也就是我们之前看到的那串字符串。</p><p>接下来我们跟进加密函数 <code>sub_4110BE</code> 得到如下：</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20220323170942563.png" alt="image-20220323170942563"></p><p>继续根据 <code>sub_411AB0</code> 函数，得到如下：</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">void</span> <span class="token operator">*</span>__cdecl <span class="token function">sub_411AB0</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>a1<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> a2<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>a3<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token keyword">int</span> v4<span class="token punctuation">;</span> <span class="token comment">// [esp+D4h] [ebp-38h]</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment">// [esp+D4h] [ebp-38h]</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token keyword">int</span> v6<span class="token punctuation">;</span> <span class="token comment">// [esp+D4h] [ebp-38h]</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">int</span> v7<span class="token punctuation">;</span> <span class="token comment">// [esp+D4h] [ebp-38h]</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [esp+E0h] [ebp-2Ch]</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v9<span class="token punctuation">;</span> <span class="token comment">// [esp+ECh] [ebp-20h]</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token keyword">int</span> v10<span class="token punctuation">;</span> <span class="token comment">// [esp+ECh] [ebp-20h]</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token keyword">int</span> v11<span class="token punctuation">;</span> <span class="token comment">// [esp+ECh] [ebp-20h]</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token keyword">void</span> <span class="token operator">*</span>v12<span class="token punctuation">;</span> <span class="token comment">// [esp+F8h] [ebp-14h]</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token keyword">char</span> <span class="token operator">*</span>v13<span class="token punctuation">;</span> <span class="token comment">// [esp+104h] [ebp-8h]</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>a1 <span class="token operator">||</span> <span class="token operator">!</span>a2 <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  v9 <span class="token operator">=</span> a2 <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a2 <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">3</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token operator">++</span>v9<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>  v10 <span class="token operator">=</span> <span class="token number">4</span> <span class="token operator">*</span> v9<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token operator">*</span>a3 <span class="token operator">=</span> v10<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>  v12 <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>v10 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>v12 <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>  <span class="token function">j_memset</span><span class="token punctuation">(</span>v12<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> v10 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>  v13 <span class="token operator">=</span> a1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>  v11 <span class="token operator">=</span> a2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>  v4 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>  <span class="token keyword">while</span> <span class="token punctuation">(</span> v11 <span class="token operator">></span> <span class="token number">0</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>  <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    byte_41A144<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    byte_41A144<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    byte_41A144<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span> <span class="token operator">&amp;&amp;</span> v11 <span class="token operator">>=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>      byte_41A144<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">*</span>v13<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>      <span class="token operator">--</span>v11<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>      <span class="token operator">++</span>v13<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>i <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="40"></td><td><pre>      <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token keyword">switch</span> <span class="token punctuation">(</span> i <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>      <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="44"></td><td><pre>        <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>v12 <span class="token operator">+</span> v4<span class="token punctuation">)</span> <span class="token operator">=</span> aAbcdefghijklmn<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8<span class="token punctuation">)</span>byte_41A144<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>        v5 <span class="token operator">=</span> v4 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>        <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>v12 <span class="token operator">+</span> v5<span class="token punctuation">)</span> <span class="token operator">=</span> aAbcdefghijklmn<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>byte_41A144<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xF0</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> <span class="token punctuation">(</span>byte_41A144<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>        <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>v12 <span class="token operator">+</span> <span class="token operator">++</span>v5<span class="token punctuation">)</span> <span class="token operator">=</span> aAbcdefghijklmn<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>        <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>v12 <span class="token operator">+</span> <span class="token operator">++</span>v5<span class="token punctuation">)</span> <span class="token operator">=</span> aAbcdefghijklmn<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>        v4 <span class="token operator">=</span> v5 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>        <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>      <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="52"></td><td><pre>        <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>v12 <span class="token operator">+</span> v4<span class="token punctuation">)</span> <span class="token operator">=</span> aAbcdefghijklmn<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8<span class="token punctuation">)</span>byte_41A144<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>        v6 <span class="token operator">=</span> v4 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>        <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>v12 <span class="token operator">+</span> v6<span class="token punctuation">)</span> <span class="token operator">=</span> aAbcdefghijklmn<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>byte_41A144<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xF0</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> <span class="token punctuation">(</span>byte_41A144<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>        <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>v12 <span class="token operator">+</span> <span class="token operator">++</span>v6<span class="token punctuation">)</span> <span class="token operator">=</span> aAbcdefghijklmn<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>byte_41A144<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xC0</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token punctuation">(</span>byte_41A144<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xF</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>        <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>v12 <span class="token operator">+</span> <span class="token operator">++</span>v6<span class="token punctuation">)</span> <span class="token operator">=</span> aAbcdefghijklmn<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>        v4 <span class="token operator">=</span> v6 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>        <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="59"></td><td><pre>      <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="60"></td><td><pre>        <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>v12 <span class="token operator">+</span> v4<span class="token punctuation">)</span> <span class="token operator">=</span> aAbcdefghijklmn<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8<span class="token punctuation">)</span>byte_41A144<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="61"></td><td><pre>        v7 <span class="token operator">=</span> v4 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="62"></td><td><pre>        <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>v12 <span class="token operator">+</span> v7<span class="token punctuation">)</span> <span class="token operator">=</span> aAbcdefghijklmn<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>byte_41A144<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xF0</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> <span class="token punctuation">(</span>byte_41A144<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="63"></td><td><pre>        <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>v12 <span class="token operator">+</span> <span class="token operator">++</span>v7<span class="token punctuation">)</span> <span class="token operator">=</span> aAbcdefghijklmn<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>byte_41A144<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xC0</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token punctuation">(</span>byte_41A144<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xF</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="64"></td><td><pre>        <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>v12 <span class="token operator">+</span> <span class="token operator">++</span>v7<span class="token punctuation">)</span> <span class="token operator">=</span> aAbcdefghijklmn<span class="token punctuation">[</span>byte_41A144<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x3F</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="65"></td><td><pre>        v4 <span class="token operator">=</span> v7 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>        <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="67"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="68"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="69"></td><td><pre>  <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span>v12 <span class="token operator">+</span> v4<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="70"></td><td><pre>  <span class="token keyword">return</span> v12<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="71"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>从加密程序可以看出 <code>aAbcdefghijklmn</code> 这个变量是加密程序的关键变量，那我们接着跟进查看 <code>aAbcdefghijklmn</code> 这个变量</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20220323171127651.png" alt="image-20220323171127651"></p><p>得到如下：</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre>aAbcdefghijklmn db 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789<span class="token operator">+</span><span class="token operator">/=</span>'</pre></td></tr></table></figure><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20220323171202397.png" alt="image-20220323171202397"></p><p>再结合前面的加密代码由 3 个字符变成 4 个字符，还有移位啥的，不难猜出这是一个 base64 加密的加密函数。</p><p>接下来就是边写解题脚本了</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> base64</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>s <span class="token operator">=</span> <span class="token string">"e3nifIH9b_C@n@dH"</span></pre></td></tr><tr><td data-num="4"></td><td><pre>flag <span class="token operator">=</span> <span class="token string">""</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>	flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> i<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>得到运行结果，也就是我们的 flag</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20220323171613096.png" alt="image-20220323171613096"></p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre>flag<span class="token punctuation">&#123;</span>i_l0ve_you<span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>如此套上 flag 即可提交成功！</p><h2 id="不一样的flag"><a class="anchor" href="#不一样的flag">#</a> 不一样的 flag</h2><p>是不是做习惯了常规的逆向题目？试试这道题，看你在能不能在程序中找到真正的 flag！注意：flag 并非是 flag {XXX} 形式，就是一个’字符串‘，考验眼力的时候到了！ 注意：得到的 flag 请包上 flag {} 提交</p><p>拿到题目，是一个 win32 的 exe 程序</p><p>程序运行如下：</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20220324174422045.png" alt="image-20220324174422045"></p><p>ida 打开，一串字符直接映入眼帘，拷贝下来，没准后面有用</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">*</span><span class="token number">11110100001010000101111</span>#</pre></td></tr></table></figure><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20220324173241146.png" alt="image-20220324173241146"></p><p>f5 跟进得到如下</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">int</span> __cdecl __noreturn <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  _BYTE v3<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+17h] [ebp-35h] BYREF</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token keyword">int</span> v4<span class="token punctuation">;</span> <span class="token comment">// [esp+34h] [ebp-18h]</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment">// [esp+38h] [ebp-14h] BYREF</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [esp+3Ch] [ebp-10h]</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  _BYTE v7<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+40h] [ebp-Ch] BYREF</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token function">__main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  v3<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token operator">*</span><span class="token punctuation">(</span>_WORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v3<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  v4 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token function">strcpy</span><span class="token punctuation">(</span>v3<span class="token punctuation">,</span> <span class="token string">"*11110100001010000101111#"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"you can choose one action to execute"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"1 up"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"2 down"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"3 left"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"4 right\n:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>v5<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span> v5 <span class="token operator">==</span> <span class="token number">2</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>      <span class="token operator">++</span><span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v3<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span> v5 <span class="token operator">></span> <span class="token number">2</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span> v5 <span class="token operator">==</span> <span class="token number">3</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>      <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token operator">--</span>v4<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>      <span class="token keyword">else</span></pre></td></tr><tr><td data-num="33"></td><td><pre>      <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span> v5 <span class="token operator">!=</span> <span class="token number">4</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre>LABEL_13<span class="token operator">:</span></pre></td></tr><tr><td data-num="36"></td><td><pre>          <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>        <span class="token operator">++</span>v4<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token keyword">else</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span> v5 <span class="token operator">!=</span> <span class="token number">1</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="43"></td><td><pre>        <span class="token keyword">goto</span> LABEL_13<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>      <span class="token operator">--</span><span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v3<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v3<span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v3<span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">4</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="49"></td><td><pre>        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span> v7<span class="token punctuation">[</span><span class="token number">5</span> <span class="token operator">*</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v3<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">41</span> <span class="token operator">+</span> v4<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">49</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="52"></td><td><pre>      <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span> v7<span class="token punctuation">[</span><span class="token number">5</span> <span class="token operator">*</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v3<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">41</span> <span class="token operator">+</span> v4<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">35</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="54"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>      <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"\nok, the order you enter is the flag!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>      <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="59"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20220324173430471.png" alt="image-20220324173430471"></p><p>根据代码可以发现，程序主要加密程序如下</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>	<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v3<span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v3<span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">4</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>	<span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">if</span> <span class="token punctuation">(</span> v7<span class="token punctuation">[</span><span class="token number">5</span> <span class="token operator">*</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v3<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">41</span> <span class="token operator">+</span> v4<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">49</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">if</span> <span class="token punctuation">(</span> v7<span class="token punctuation">[</span><span class="token number">5</span> <span class="token operator">*</span> <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v3<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">41</span> <span class="token operator">+</span> v4<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">35</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"\nok, the order you enter is the flag!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>提示信息是让左右移动，很容易知道这是一个<strong>横向为 5 迷宫</strong>题</p><p>可知是<strong>碰到 1 则退出，以 * 为起点，最终需要走到#</strong></p><p>如此得到迷宫结构如下：</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">*</span><span class="token number">1111</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token number">01000</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token number">01010</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token number">00010</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token number">1111</span>#</pre></td></tr></table></figure><p>根据运行结果可以知道要想出去的路径为 <code>222441144222</code></p><p>而这也就是我们想要的 flag 了</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre>flag<span class="token punctuation">&#123;</span><span class="token number">222441144222</span><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="simplerev"><a class="anchor" href="#simplerev">#</a> SimpleRev</h2><p>SimpleRev (flag 需加上 flag {} 再提交) 注意：得到的 flag 请包上 flag {} 提交</p><p>pe 查壳，并没有套什么壳，而且我们可以知道是 64 位</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20220325131354054.png" alt="image-20220325131354054"></p><p>ida pro 分析</p><p>一番查找并没有发现什么有用的东西</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20220325131746956.png" alt="image-20220325131746956"></p><p>f5 反编译得到如下：</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">int</span> __cdecl __noreturn <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment">// eax</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token keyword">char</span> v4<span class="token punctuation">;</span> <span class="token comment">// [rsp+Fh] [rbp-1h]</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>      <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Welcome to CTF game!\nPlease input d/D to start or input q/Q to quit this program: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      v4 <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span> v4 <span class="token operator">!=</span> <span class="token number">100</span> <span class="token operator">&amp;&amp;</span> v4 <span class="token operator">!=</span> <span class="token number">68</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>      <span class="token function">Decry</span><span class="token punctuation">(</span><span class="token string">"Welcome to CTF game!\nPlease input d/D to start or input q/Q to quit this program: "</span><span class="token punctuation">,</span> argv<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span> v4 <span class="token operator">==</span> <span class="token number">113</span> <span class="token operator">||</span> v4 <span class="token operator">==</span> <span class="token number">81</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>      <span class="token function">Exit</span><span class="token punctuation">(</span><span class="token string">"Welcome to CTF game!\nPlease input d/D to start or input q/Q to quit this program: "</span><span class="token punctuation">,</span> argv<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Input fault format!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    v3 <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token function">putchar</span><span class="token punctuation">(</span>v3<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20220325131906057.png" alt="image-20220325131906057"></p><p>分析主函数可知关键代码如下：</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>      <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Welcome to CTF game!\nPlease input d/D to start or input q/Q to quit this program: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>      v4 <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span> v4 <span class="token operator">!=</span> <span class="token number">100</span> <span class="token operator">&amp;&amp;</span> v4 <span class="token operator">!=</span> <span class="token number">68</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token function">Decry</span><span class="token punctuation">(</span><span class="token string">"Welcome to CTF game!\nPlease input d/D to start or input q/Q to quit this program: "</span><span class="token punctuation">,</span> argv<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>重点肯定在 Decry () 这个函数里，点击跟进如下：</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">unsigned</span> __int64 <span class="token function">Decry</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token keyword">char</span> v1<span class="token punctuation">;</span> <span class="token comment">// [rsp+Fh] [rbp-51h]</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token keyword">int</span> v2<span class="token punctuation">;</span> <span class="token comment">// [rsp+10h] [rbp-50h]</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment">// [rsp+14h] [rbp-4Ch]</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [rsp+18h] [rbp-48h]</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment">// [rsp+1Ch] [rbp-44h]</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token keyword">char</span> src<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+20h] [rbp-40h] BYREF</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  __int64 v7<span class="token punctuation">;</span> <span class="token comment">// [rsp+28h] [rbp-38h]</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token keyword">int</span> v8<span class="token punctuation">;</span> <span class="token comment">// [rsp+30h] [rbp-30h]</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  __int64 v9<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+40h] [rbp-20h] BYREF</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token keyword">int</span> v10<span class="token punctuation">;</span> <span class="token comment">// [rsp+50h] [rbp-10h]</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token keyword">unsigned</span> __int64 v11<span class="token punctuation">;</span> <span class="token comment">// [rsp+58h] [rbp-8h]</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>  v11 <span class="token operator">=</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token operator">*</span><span class="token punctuation">(</span>_QWORD <span class="token operator">*</span><span class="token punctuation">)</span>src <span class="token operator">=</span> <span class="token number">0x534C43444ELL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">// 16 进制编码为‘0x534c43444e’数据在内存中是小端顺序，高位在高地址处，低位在低地址处，故实际的字符顺序应为 '0x4e44434c53' 转为字符为 'NDCLS'</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  v7 <span class="token operator">=</span> <span class="token number">0LL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>  v8 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>  v9<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x776F646168LL</span><span class="token punctuation">;</span> <span class="token comment">// 同理解出为 'hadow'</span></pre></td></tr><tr><td data-num="21"></td><td><pre>  v9<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0LL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>  v10 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>  text <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">join</span><span class="token punctuation">(</span>key3<span class="token punctuation">,</span> v9<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//key3='kills'  ; 这个 join 函数，就是把 key3 和 v9 两个字符串相连即 'killshadow'</span></pre></td></tr><tr><td data-num="24"></td><td><pre>  <span class="token function">strcpy</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> key1<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>  <span class="token function">strcat</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> src<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// key1 = 'ADSFK',key = 'ADSFKNDCLS'</span></pre></td></tr><tr><td data-num="26"></td><td><pre>  v2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>  v3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token comment">// 这里是对一些变量赋值其中 text,strcpy,strcat 中出现了 key 需要注意一下这里是把 key1,src 的值拷贝到 key 中而 text 这里有一个字符串类型的指针指向的地址上的值就是 key3+v9</span></pre></td></tr><tr><td data-num="29"></td><td><pre>  <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>  v5 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> v5<span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>  <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span> key<span class="token punctuation">[</span>v3 <span class="token operator">%</span> v5<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">64</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">[</span>v3 <span class="token operator">%</span> v5<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">90</span> <span class="token punctuation">)</span><span class="token comment">// 将 key 的字符转为小写的算法，即 key = 'adsfkndcls'</span></pre></td></tr><tr><td data-num="34"></td><td><pre>      key<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> key<span class="token punctuation">[</span>v3 <span class="token operator">%</span> v5<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">32</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token operator">++</span>v3<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token comment">// 注意这里有一个 for 循环这个循环的作用就是对 key 的值进行大小写转化，而 v5 的值也就是 key 的长度通过 strlen 读取而得。</span></pre></td></tr><tr><td data-num="38"></td><td><pre>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Please input your flag:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>  <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="40"></td><td><pre>  <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    v1 <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span> v1 <span class="token operator">==</span> <span class="token number">10</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="43"></td><td><pre>      <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span> v1 <span class="token operator">==</span> <span class="token number">32</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>      <span class="token operator">++</span>v2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>    <span class="token keyword">else</span></pre></td></tr><tr><td data-num="49"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span> v1 <span class="token operator">&lt;=</span> <span class="token number">96</span> <span class="token operator">||</span> v1 <span class="token operator">></span> <span class="token number">122</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="51"></td><td><pre>      <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span> v1 <span class="token operator">></span> <span class="token number">64</span> <span class="token operator">&amp;&amp;</span> v1 <span class="token operator">&lt;=</span> <span class="token number">90</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="53"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>          str2<span class="token punctuation">[</span>v2<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>v1 <span class="token operator">-</span> <span class="token number">39</span> <span class="token operator">-</span> key<span class="token punctuation">[</span>v3 <span class="token operator">%</span> v5<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">97</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">+</span> <span class="token number">97</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>          <span class="token operator">++</span>v3<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>      <span class="token keyword">else</span></pre></td></tr><tr><td data-num="59"></td><td><pre>      <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="60"></td><td><pre>        str2<span class="token punctuation">[</span>v2<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>v1 <span class="token operator">-</span> <span class="token number">39</span> <span class="token operator">-</span> key<span class="token punctuation">[</span>v3 <span class="token operator">%</span> v5<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">97</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">+</span> <span class="token number">97</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="61"></td><td><pre>        <span class="token operator">++</span>v3<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="62"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="63"></td><td><pre><span class="token comment">// 这里就是核心了也就是对你输入的字符进行处理</span></pre></td></tr><tr><td data-num="64"></td><td><pre><span class="token comment">// 第一个 if 是判断你输入的是否是小写字母</span></pre></td></tr><tr><td data-num="65"></td><td><pre><span class="token comment">// 第二个 if 是判断你输入的是否为大写字母</span></pre></td></tr><tr><td data-num="66"></td><td><pre><span class="token comment">// 在第二个 if 下面就是对 str2 [v2] 进行 (v1 - 39 - key [v3++ % v5] + 97) % 26 + 97 处理变换后 str2 [v1] 存放小写字母下面的操作类似就不分析了</span></pre></td></tr><tr><td data-num="67"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token punctuation">(</span>v3 <span class="token operator">%</span> v5<span class="token punctuation">)</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="68"></td><td><pre>        <span class="token function">putchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="69"></td><td><pre>      <span class="token operator">++</span>v2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="70"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="71"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="72"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">strcmp</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> str2<span class="token punctuation">)</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="73"></td><td><pre>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Congratulation!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="74"></td><td><pre>  <span class="token keyword">else</span></pre></td></tr><tr><td data-num="75"></td><td><pre>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Try again!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="76"></td><td><pre>  <span class="token keyword">return</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span> <span class="token operator">^</span> v11<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="77"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20220325132258086.png" alt="image-20220325132258086"></p><p>方法一：（直接公式逆推）</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>text <span class="token operator">=</span> <span class="token string">'killshadow'</span><span class="token comment">#=str2</span></pre></td></tr><tr><td data-num="2"></td><td><pre>key <span class="token operator">=</span> <span class="token string">'adsfkndcls'</span></pre></td></tr><tr><td data-num="3"></td><td><pre>v3 <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="4"></td><td><pre>v5 <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>n <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="6"></td><td><pre>flag <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        v1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>text<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">97</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">26</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span>v3 <span class="token operator">%</span> v5<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">58</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>v1 <span class="token operator">></span> <span class="token number">65</span> <span class="token keyword">and</span> v1 <span class="token operator">&lt;=</span> <span class="token number">90</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token punctuation">(</span>v1 <span class="token operator">>=</span> <span class="token number">97</span> <span class="token keyword">and</span> v5 <span class="token operator">&lt;=</span> <span class="token number">122</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>            flag<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>v1<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>            n <span class="token operator">=</span> n <span class="token operator">+</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="13"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>                <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>                <span class="token keyword">break</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        v3 <span class="token operator">=</span> v3 <span class="token operator">+</span> <span class="token number">1</span></pre></td></tr></table></figure><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20220325133843127.png" alt="image-20220325133843127"></p><p>方法二：写字典暴力密码正向破解</p><p>爆破一：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>text <span class="token operator">=</span> <span class="token string">'killshadow'</span><span class="token comment">#=str2</span></pre></td></tr><tr><td data-num="2"></td><td><pre>key <span class="token operator">=</span> <span class="token string">'adsfkndcls'</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">#暴力字典破解</span></pre></td></tr><tr><td data-num="5"></td><td><pre>v3 <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="6"></td><td><pre>v5 <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>dict1 <span class="token operator">=</span> <span class="token string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"</span></pre></td></tr><tr><td data-num="8"></td><td><pre>flag <span class="token operator">=</span> <span class="token string">""</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    n <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">for</span> char <span class="token keyword">in</span> dict1<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        x <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">39</span> <span class="token operator">-</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span>v3 <span class="token operator">%</span> v5<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">97</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">+</span> <span class="token number">97</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">==</span> text<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>            n <span class="token operator">=</span> n <span class="token operator">+</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="15"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="16"></td><td><pre>                <span class="token keyword">print</span><span class="token punctuation">(</span>char<span class="token punctuation">,</span>end <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    v3 <span class="token operator">=</span> v3 <span class="token operator">+</span> <span class="token number">1</span></pre></td></tr></table></figure><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20220325134207108.png" alt="image-20220325134207108"></p><p>爆破二：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>key1 <span class="token operator">=</span> <span class="token string">'adsfkndcls'</span></pre></td></tr><tr><td data-num="2"></td><td><pre>key2 <span class="token operator">=</span> <span class="token string">'killshadow'</span></pre></td></tr><tr><td data-num="3"></td><td><pre>text <span class="token operator">=</span> <span class="token string">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span></pre></td></tr><tr><td data-num="4"></td><td><pre>flag <span class="token operator">=</span> <span class="token string">""</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>key1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">for</span> j <span class="token keyword">in</span> text<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token keyword">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>key2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">39</span> <span class="token operator">-</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>key1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token number">97</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token operator">+</span><span class="token number">97</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>            flag <span class="token operator">+=</span> j</pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'flag&#123;'</span> <span class="token operator">+</span> flag <span class="token operator">+</span> <span class="token string">'&#125;'</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2022/image-20220325134532006.png" alt="image-20220325134532006"></p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre>flag<span class="token punctuation">&#123;</span>KLDQCUDFZO<span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="java逆向解密"><a class="anchor" href="#java逆向解密">#</a> Java 逆向解密</h2><p>程序员小张不小心弄丢了加密文件用的秘钥，已知还好小张曾经编写了一个秘钥验证算法，聪明的你能帮小</p><p>张找到秘钥吗？ 注意：得到的 flag 请包上 flag {} 提交</p><p>附件下载，是个.class 文件</p><p>jd-gui 打开文件，反编译结果如下</p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Scanner</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Reverse</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token class-name">Scanner</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>"<span class="token class-name">Please</span> input the flag <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token class-name">String</span> str <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>"<span class="token class-name">Your</span> input is <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> stringArr <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token class-name">Encrypt</span><span class="token punctuation">(</span>stringArr<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  </pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Encrypt</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> <span class="token class-name">Resultlist</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>      <span class="token keyword">int</span> result <span class="token operator">=</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">64</span> <span class="token operator">^</span> <span class="token number">0x20</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>      <span class="token class-name">Resultlist</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> KEY <span class="token operator">=</span> <span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">136</span><span class="token punctuation">,</span> <span class="token number">137</span><span class="token punctuation">,</span> <span class="token number">147</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">137</span><span class="token punctuation">,</span> <span class="token number">147</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">148</span><span class="token punctuation">,</span> <span class="token number">136</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token number">133</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">134</span><span class="token punctuation">,</span> <span class="token number">140</span><span class="token punctuation">,</span> <span class="token number">129</span><span class="token punctuation">,</span> <span class="token number">135</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">65</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> <span class="token class-name">KEYList</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> KEY<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>      <span class="token class-name">KEYList</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>KEY<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Result:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Resultlist</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">KEYList</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>"<span class="token class-name">Congratulations</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>      <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>"<span class="token class-name">Error</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="33"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/image-20220326202848427.png" alt="image-20220326202848427"></p><p>根据源代码分析可知，我们输入一个字符串，然后经过一个 Encrypt 函数进行处理，在 Encrypt 函数中经过一</p><p>个 for 循环进行异或，然后将得到的新字符串与 KEY 进行比较，看看是否相等，根据判断结果输出 Result。</p><p>KEY 的值：</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>KEY <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">180</span>, <span class="token number">136</span>, <span class="token number">137</span>, <span class="token number">147</span>, <span class="token number">191</span>, <span class="token number">137</span>, <span class="token number">147</span>, <span class="token number">191</span>, <span class="token number">148</span>, <span class="token number">136</span>, <span class="token number">133</span>, <span class="token number">191</span>, <span class="token number">134</span>, <span class="token number">140</span>, <span class="token number">129</span>, <span class="token number">135</span>, <span class="token number">191</span>, <span class="token number">65</span> <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>异或条件：</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>result <span class="token operator">=</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> + <span class="token number">64</span> ^ 0x20<span class="token punctuation">;</span></pre></td></tr></table></figure><p>Python 异或代码：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>flag <span class="token operator">=</span> <span class="token string">""</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token builtin">str</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">136</span><span class="token punctuation">,</span> <span class="token number">137</span><span class="token punctuation">,</span> <span class="token number">147</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">137</span><span class="token punctuation">,</span> <span class="token number">147</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">148</span><span class="token punctuation">,</span> <span class="token number">136</span><span class="token punctuation">,</span> <span class="token number">133</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">134</span><span class="token punctuation">,</span> <span class="token number">140</span><span class="token punctuation">,</span> <span class="token number">129</span><span class="token punctuation">,</span> <span class="token number">135</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>	flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'@'</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x20</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr></table></figure><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/image-20220326203743067.png" alt="image-20220326203743067"></p><p>java 异或代码：</p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">class</span> xor<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> KEY <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">136</span><span class="token punctuation">,</span> <span class="token number">137</span><span class="token punctuation">,</span> <span class="token number">147</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">137</span><span class="token punctuation">,</span> <span class="token number">147</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">148</span><span class="token punctuation">,</span> <span class="token number">136</span><span class="token punctuation">,</span> <span class="token number">133</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">134</span><span class="token punctuation">,</span> <span class="token number">140</span><span class="token punctuation">,</span> <span class="token number">129</span><span class="token punctuation">,</span> <span class="token number">135</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">65</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token class-name">String</span> flag <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> KEY<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i <span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>            <span class="token keyword">char</span> x <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span>KEY<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token char">'@'</span><span class="token operator">^</span><span class="token number">0x20</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>            flag <span class="token operator">+=</span> x<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/image-20220326204938652.png" alt="image-20220326204938652"></p><h2 id="gxyctf2019luck_guy"><a class="anchor" href="#gxyctf2019luck_guy">#</a> [GXYCTF2019]luck_guy</h2><p>得到的 flag 请包上 flag {} 提交。</p><p>附件下载，查壳</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/image-20220327185052623.png" alt="image-20220327185052623"></p><p>无壳，且 64 位程序，用 64 位的 ida pro 打开</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/image-20220327185134766.png" alt="image-20220327185134766"></p><p>不难发现 patch_me 是一个关键函数</p><p>f5 反编译如下</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/image-20220327185253300.png" alt="image-20220327185253300"></p><p>意思就是将输入的字符串存到 v4 中，然后作为 patch_me () 函数的参数</p><p>跟进 patch_me () 函数如下：</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/image-20220327185347891.png" alt="image-20220327185347891"></p><p>跟进 get_flag 函数，得到如下结果：</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/image-20220327185426137.png" alt="image-20220327185426137"></p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">unsigned</span> __int64 <span class="token function">get_flag</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v0<span class="token punctuation">;</span> <span class="token comment">// eax</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [rsp+4h] [rbp-3Ch]</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token keyword">int</span> j<span class="token punctuation">;</span> <span class="token comment">// [rsp+8h] [rbp-38h]</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  __int64 s<span class="token punctuation">;</span> <span class="token comment">// [rsp+10h] [rbp-30h] BYREF</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token keyword">char</span> v5<span class="token punctuation">;</span> <span class="token comment">// [rsp+18h] [rbp-28h]</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token keyword">unsigned</span> __int64 v6<span class="token punctuation">;</span> <span class="token comment">// [rsp+38h] [rbp-8h]</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>  v6 <span class="token operator">=</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  v0 <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token number">0LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token function">srand</span><span class="token punctuation">(</span>v0<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">switch</span> <span class="token punctuation">(</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">200</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>      <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"OK, it's flag:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>s<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0x28uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token function">strcat</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>s<span class="token punctuation">,</span> f1<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token function">strcat</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>s<span class="token punctuation">,</span> <span class="token operator">&amp;</span>f2<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>      <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Solar not like you"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>      <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Solar want a girlfriend"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>      <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        s <span class="token operator">=</span> <span class="token number">0x7F666F6067756369LL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        v5 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>        <span class="token function">strcat</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>f2<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>        <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>      <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> <span class="token number">7</span><span class="token punctuation">;</span> <span class="token operator">++</span>j <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>          <span class="token keyword">if</span> <span class="token punctuation">(</span> j <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre>            <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>f2 <span class="token operator">+</span> j<span class="token punctuation">)</span> <span class="token operator">-=</span> <span class="token number">2</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>          <span class="token keyword">else</span></pre></td></tr><tr><td data-num="41"></td><td><pre>            <span class="token operator">--</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>f2 <span class="token operator">+</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>        <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>      <span class="token keyword">default</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="45"></td><td><pre>        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"emmm,you can't find flag 23333"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>        <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>  <span class="token keyword">return</span> <span class="token function">__readfsqword</span><span class="token punctuation">(</span><span class="token number">0x28u</span><span class="token punctuation">)</span> <span class="token operator">^</span> v6<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>前面可以进行如下分析</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/image-20220327185727822.png" alt="image-20220327185727822"></p><p>f1 字符串</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/image-20220327185804806.png" alt="image-20220327185804806"></p><p>f1，f2 分析如下：</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/image-20220327185913533.png" alt="image-20220327185913533"></p><p>s 分析结果如下</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token number">0x7F</span> <span class="token number">0x66</span> <span class="token number">0x6F</span> <span class="token number">0x60</span> <span class="token number">0x67</span> <span class="token number">0x75</span> <span class="token number">0x63</span> <span class="token number">0x69</span></pre></td></tr></table></figure><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/image-20220327190254779.png" alt="image-20220327190254779"></p><p>由此可以看出 flag 是由 f1 和 f2 拼接而成，而 f1 已经给出，接下来只要破解 f2 即可得到 flag</p><p>而在 case4 中对 f2 进行赋值，在 f5 中对 f2 进行处理</p><p>脚本编写：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>flag <span class="token operator">=</span> <span class="token string">'GXY&#123;do_not_'</span></pre></td></tr><tr><td data-num="2"></td><td><pre>f2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x7F</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x6F</span><span class="token punctuation">,</span> <span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0x75</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0x69</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="3"></td><td><pre>s <span class="token operator">=</span> <span class="token string">''</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">if</span> i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        s <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>f2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        s <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>f2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    flag <span class="token operator">+=</span> s</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr></table></figure><p>python 允许结果如下</p><p><img data-src="https://21r000-image.oss-cn-shanghai.aliyuncs.com/pic2021/image-20220327190739029.png" alt="image-20220327190739029"></p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre>flag<span class="token punctuation">&#123;</span>do_not_hate_me<span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="博文有待更新作者还需努力"><a class="anchor" href="#博文有待更新作者还需努力">#</a> 博文有待更新，作者还需努力！！！</h2><div class="tags"><a href="/tags/Re/" rel="tag"><i class="ic i-tag"></i> Re</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2022-03-27 19:08:36" itemprop="dateModified" datetime="2022-03-27T19:08:36+08:00">2022-03-27</time> </span><span id="article/c9a43e3e.html" class="item leancloud_visitors" data-flag-title="Buu-Re刷题记录" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>21r000 <i class="ic i-at"><em>@</em></i>未入江湖，怎敢佩刀</li><li class="link"><strong>本文链接：</strong> <a href="https://www.21r000.xyz/article/c9a43e3e.html" title="Buu-Re刷题记录">https://www.21r000.xyz/article/c9a43e3e.html</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/article/a97dc026.html" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;21r000-image.oss-cn-shanghai.aliyuncs.com&#x2F;pic2021&#x2F;image-20211228150436652.png" title="信息收集自动化工具-水泽使用记录"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> STools</span><h3>信息收集自动化工具-水泽使用记录</h3></a></div><div class="item right"><a href="/article/ca1a73d0.html" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;21r000-image.oss-cn-shanghai.aliyuncs.com&#x2F;pic2021&#x2F;6833939bly1giclgrvbd6j20zk0m8qv5.jpg" title="逆向工程Studying Notes Days 5"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 逆向工程</span><h3>逆向工程Studying Notes Days 5</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#easyre"><span class="toc-number">1.</span> <span class="toc-text">easyre</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reverse1"><span class="toc-number">2.</span> <span class="toc-text">reverse1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reverse2"><span class="toc-number">3.</span> <span class="toc-text">reverse2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E6%B6%B5%E7%9A%84%E8%BD%AF%E4%BB%B6"><span class="toc-number">4.</span> <span class="toc-text">内涵的软件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B0%E5%B9%B4%E5%BF%AB%E4%B9%90"><span class="toc-number">5.</span> <span class="toc-text">新年快乐</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xor"><span class="toc-number">6.</span> <span class="toc-text">xor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#helloword"><span class="toc-number">7.</span> <span class="toc-text">helloword</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reverse3"><span class="toc-number">8.</span> <span class="toc-text">reverse3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84flag"><span class="toc-number">9.</span> <span class="toc-text">不一样的 flag</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#simplerev"><span class="toc-number">10.</span> <span class="toc-text">SimpleRev</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#java%E9%80%86%E5%90%91%E8%A7%A3%E5%AF%86"><span class="toc-number">11.</span> <span class="toc-text">Java 逆向解密</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gxyctf2019luck_guy"><span class="toc-number">12.</span> <span class="toc-text">[GXYCTF2019]luck_guy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%9A%E6%96%87%E6%9C%89%E5%BE%85%E6%9B%B4%E6%96%B0%E4%BD%9C%E8%80%85%E8%BF%98%E9%9C%80%E5%8A%AA%E5%8A%9B"><span class="toc-number">13.</span> <span class="toc-text">博文有待更新，作者还需努力！！！</span></a></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/article/4610d5dd.html" rel="bookmark" title="四进制解码">四进制解码</a></li><li><a href="/article/66f43719.html" rel="bookmark" title="二进制解码">二进制解码</a></li><li><a href="/article/8d4c4fc4.html" rel="bookmark" title="第四届浙江省网络安全技能竞赛决赛部分WP">第四届浙江省网络安全技能竞赛决赛部分WP</a></li><li><a href="/article/8f0d21b8.html" rel="bookmark" title="第四届浙江省大学生网络与信息安全竞赛（决赛）dssssa1及easyNTRU复现">第四届浙江省大学生网络与信息安全竞赛（决赛）dssssa1及easyNTRU复现</a></li><li><a href="/article/f287aeaa.html" rel="bookmark" title="pyc反编译那些事儿">pyc反编译那些事儿</a></li><li><a href="/article/ec7d43d7.html" rel="bookmark" title="强网杯_mailbox2">强网杯_mailbox2</a></li><li><a href="/article/84f3998a.html" rel="bookmark" title="2021HECTF—河北师范大学信息安全挑战赛部分WP">2021HECTF—河北师范大学信息安全挑战赛部分WP</a></li><li><a href="/article/243479c5.html" rel="bookmark" title="陇原战疫2021网络安全大赛_Crypto部分WP">陇原战疫2021网络安全大赛_Crypto部分WP</a></li><li><a href="/article/b5c81d74.html" rel="bookmark" title="CTFshow 月饼杯crypto1_中秋月wp">CTFshow 月饼杯crypto1_中秋月wp</a></li><li><a href="/article/dcbf7c1a.html" rel="bookmark" title="CTFshow月饼杯Crypto2_月自圆WP">CTFshow月饼杯Crypto2_月自圆WP</a></li><li><a href="/article/a7cc6afa.html" rel="bookmark" title="CTFshow月饼杯Crypto3_多少离杯WP">CTFshow月饼杯Crypto3_多少离杯WP</a></li><li class="active"><a href="/article/c9a43e3e.html" rel="bookmark" title="Buu-Re刷题记录">Buu-Re刷题记录</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="21r000" data-src="/images/avatar.jpg"><p class="name" itemprop="name">21r000</p><div class="description" itemprop="description">固态规则长方体空间移动工程师</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">75</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">12</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">15</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item Github" data-url="aHR0cHM6Ly9naXRodWIuY29tLzIxcjAwMA==" title="https:&#x2F;&#x2F;github.com&#x2F;21r000"><i class="ic i-github"></i></span> <span class="exturl item QQ" data-url="dGVuY2VudDovL21lc3NhZ2UvP3Vpbj0yODU1MTQ1MTEzJlNpdGU9Jk1lbnU9eWVz" title="tencent:&#x2F;&#x2F;message&#x2F;?uin&#x3D;2855145113&amp;Site&#x3D;&amp;Menu&#x3D;yes"><i class="ic i-qq"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/books/" rel="section"><i class="ic i-instagram"></i>图书阁</a></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友联</a></li><li class="item"><a href="/links/" rel="section"><i class="ic i-magic"></i>传送阵</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/article/a97dc026.html" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/article/ca1a73d0.html" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/CTF/" title="分类于 CTF">CTF</a></div><span><a href="/article/dcbf7c1a.html" title="CTFshow月饼杯Crypto2_月自圆WP">CTFshow月饼杯Crypto2_月自圆WP</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" title="分类于 内网渗透">内网渗透</a></div><span><a href="/article/cdbe6e7b.html" title="浅谈内网渗透中有关隧道的那些事儿">浅谈内网渗透中有关隧道的那些事儿</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" title="分类于 内网渗透">内网渗透</a></div><span><a href="/article/fc890dcf.html" title="Windows环境下信息收集与内网定位">Windows环境下信息收集与内网定位</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%B1%87%E7%BC%96/" title="分类于 汇编">汇编</a></div><span><a href="/article/28bedc94.html" title="汇编语言Studying Note之JMP和LOOP学习">汇编语言Studying Note之JMP和LOOP学习</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/STools/" title="分类于 STools">STools</a></div><span><a href="/article/159145e.html" title="批量漏洞挖掘工具QS的安装与使用教程">批量漏洞挖掘工具QS的安装与使用教程</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/C%E8%AF%AD%E8%A8%80/" title="分类于 C语言">C语言</a></div><span><a href="/article/7625eb58.html" title="C语言复习总结">C语言复习总结</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/SNote/" title="分类于 SNote">SNote</a></div><span><a href="/article/141d7194.html" title="使用PicGo+Github&#x2F;Gitee+Typroa搭建属于自己的图床">使用PicGo+Github/Gitee+Typroa搭建属于自己的图床</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/" title="分类于 逆向工程">逆向工程</a></div><span><a href="/article/bd1d4346.html" title="逆向工程Studying Notes Days 4">逆向工程Studying Notes Days 4</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/STools/" title="分类于 STools">STools</a></div><span><a href="/article/ce12b2b3.html" title="Typroa破解记录">Typroa破解记录</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" title="分类于 内网渗透">内网渗透</a></div><span><a href="/article/ffbd8b0.html" title="windows信息搜集篇（二）之SPN">windows信息搜集篇（二）之SPN</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2021 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="ic i-"></i> </span><span class="author" itemprop="copyrightHolder">21r000 @ 21r000</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">302k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">4:35</span></div><div><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_pv">本站总访问量：<span id="busuanzi_value_site_pv"></span>次</span> <span class="post-meta-divider">|</span> <span id="busuanzi_container_site_uv" style="display:none">本站访客数：<span id="busuanzi_value_site_uv"></span>人</span></div><div class="beian-info"><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/">浙ICP备2022001000号-1</a></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"article/c9a43e3e.html",favicon:{show:"（●´3｀●）大通りからジェーンまで",hide:"(´Д｀)金を独行する"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,model:{jsonPath:"/live2dw/assets/wanko.model.json"},display:{position:"right",width:150,height:200},mobile:{show:!1},log:!1})</script></body></html><!-- rebuild by hrmmi -->